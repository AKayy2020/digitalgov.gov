{{ define "content" }}

<main role="main" class="page">
  <article>

    <header>
      <div class="grid-container grid-container-desktop">
        <div class="grid-row">
          <div class="grid-col-12" data-edit-this="/edit/{{- .Type -}}/?page=https://demo.digital.gov{{- (urls.Parse .Permalink).Path -}}">

            <p class="breadcrumb"><a href="{{ .Parent.Permalink }}" title="{{ .Parent.Title }}"><i class="fas fa-arrow-left"></i> <span>{{ .Parent.Title }}</span></a></p>
            {{/* Page Title */}}
            <h1>{{ .Title | markdownify }} Community</h1>

            {{/* Deck */}}
            {{- if .Params.deck -}}
            <div class="deck font-sans-xl text-light">{{- .Params.deck | markdownify -}}</div>
            {{- end -}}

          </div>
        </div>
      </div>
    </header>

    <section>
      <div class="grid-container grid-container-desktop">
        <div class="grid-row grid-gap-4">
          <div class="grid-col-12 tablet-lg:grid-col-4">
            {{- if .Params.community_list -}}
            <section class="community-info {{ .Params.community_type -}}">

              {{- range $i, $e := .Params.community_list -}}
                <div class="join-box">

                  <!-- Join by email -->
                  <!-- type == listserv -->
                  {{- if and (eq $e.type "listserv") (not $e.form ) -}}
                    <a href="mailto:{{- $e.subscribe_email -}}
                    {{- if $e.subject -}}
                      ?subject={{- $e.subject -}}
                      {{- if $e.body -}}
                        &body={{- $e.body -}}
                      {{- end -}}
                    {{- else -}}
                      {{- if $e.body -}}
                        ?body={{- $e.body -}}
                      {{- end -}}
                    {{- end -}}" class="join"><i class="fas fa-envelope"></i> Join by email</a>

                    <p>To join, email <strong>{{ $e.subscribe_email }}</strong> with {{ if $e.subject }} <code>{{ $e.subject }}</code>{{ else }} nothing {{ end }} in the subject {{- if $e.body }} and <code>{{ $e.body }}</code> in the body{{- end -}}.</p>
                  {{- end -}}


                  <!-- Join by form -->
                  <!-- type == listserv + form  -->
                  {{- if and (eq $e.type "listserv") ( $e.form ) -}}
                    <a href="{{ $e.form }}" class="join" title="Join the {{ .Title | markdownify }} Community"><i class="fas fa-file-signature"></i> Join via our form</a>

                    <p>To join, <a href="{{ $e.form }}" title="Fill out our form">fill out our form</a>{{ if $e.subscribe_email }} or email <strong>{{ $e.subscribe_email }}</strong> with {{ if $e.subject }} <code>{{ $e.subject }}</code>{{ else }} nothing {{ end }} in the subject {{- if $e.body }} and <code>{{ $e.body }}</code> in the body{{- end -}}{{- end -}}.</p>
                  {{- end -}}

                  <!-- Join Google Group -->
                  <!-- type == google-group + form -->
                  {{- if and (eq $e.type "google-group") ( $e.form ) -}}
                    <a href="{{- $e.form -}}" class="join type-{{- $e.type -}}"><i class="fab fa-google"></i> Join the Google Group</a>

                    <p>To join, fill out our form or email <strong>{{ $e.subscribe_email }}</strong> with {{ if $e.subject }} <code>{{ $e.subject }}</code>{{ else }} nothing {{ end }} in the subject {{- if $e.body }} and <code>{{ $e.body }}</code> in the body{{- end -}}.</p>
                  {{- end -}}

                  <!-- Community Terms -->
                  {{/* Checking to see if community_terms are defined */}}
                  {{- if $e.terms -}}
                  <p class="terms"><em>{{- $e.terms | markdownify -}}</em></p>
                  {{- else -}}
                  <p class="terms"><em>Anyone with a .gov or .mil email address is eligible to join.</em></p>
                  {{- end -}}

                </div>

              {{- end -}}

              {{- if .Params.community_managers -}}
              <div class="community_managers">
                {{- partial "core/get_authors" . -}}
              </div>
              {{- end -}}

              <div class="community_admin">
                {{- if $.Params.members -}}
                  <p class="members"><i class="far fa-user"></i> {{ $.Params.members }} members
                  {{- if $.Params.emails_per_week }}
                   <br/> <i class="far fa-envelope"></i> Avg. {{ $.Params.emails_per_week }} emails per week{{- end -}}</p>
                {{- end -}}

                <p class="listserv-links"><a href="https://digital.gov/communities/manage-your-subscription/" title="Manage Your Listserv Subscription">Manage Your Listserv Subscription</a><br/><a href="https://digital.gov/communities/manage-your-subscription#Access-Listserv-Archive" title="Access the Listserv Archive">Access the Listserv Archive</a></p>
              </div>

            </section>
            {{ end }}
          </div>

          <div class="grid-col-12 tablet-lg:grid-col-8">
            <div class="content">
              {{ .Content }}
            </div>

            {{- partial "core/feedback" (dict "page" . "page_type" "community" "branch" ($.Scratch.Get "branch")) -}}

          </div>

        </div>
      </div>
    </section>
  </article>
</main>

{{ end }} {{/* end 'content' block */}}
